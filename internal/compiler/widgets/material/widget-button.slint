import { Palette } from "theme-palette.slint";

// Default button widget with Material Design Elevated Button look and feel.
export Button := TouchArea {
    callback clicked;
    property<string> text <=> text.text;
    property<bool> has-focus <=> fs.has-focus;
    property<bool> checkable;
    property<bool> checked;
    property<image> icon;
    property<length> font-size: 14pt;

    accessible-label <=> text.text;
    accessible-role: button;

    height: 40pt;
    min-width: 40pt;
   
    rect := Rectangle {  
        width: 100%;
        height: 100%;

        border-radius: 20pt;
        background: Palette.md-surface;
        drop-shadow-color: Palette.md-shadow;
        drop-shadow-blur: 1pt;
        drop-shadow-offset-y: 1pt;
    }

    HorizontalLayout {  
        padding-left: 24pt;
        padding-right: 24pt;
        spacing: 8pt;
        text := Text {
            color: Palette.md-primary;
            vertical-alignment: center;
           
            font-size <=> root.font-size;
        }
    }

    state-layer := Rectangle {  
        opacity: 0;
        width: 100%;
        height: 100%;
        border-radius: rect.border-radius;
        background: Palette.md-primary;
     }

    touch := TouchArea {
        clicked => {
            if (root.checkable) {
                root.checked = !root.checked;
            }
            root.clicked();
        }
    }

    fs := FocusScope {
        width: 0px; // Do not react on clicks
        enabled <=> root.enabled;
        key-pressed(event) => {
            if (event.text == " " || event.text == "\n") {
                 touch.clicked();
                 return accept;
            }
            return reject;
        }
    }

    states [
        disabled when !root.enabled : {
            rect.drop-shadow-blur: 0pt;
            rect.opacity: 0.12;
            text.opacity: 0.38;
        }
        pressed when touch.pressed : {
            state-layer.opacity: 0.08;
        }
        hover when touch.has-hover : {
            state-layer.opacity: 0.08;
            rect.drop-shadow-blur: 2pt;
        }
        focused when fs.has-focus : {
            state-layer.opacity: 0.12;
        }
    ]
}