// Copyright © Klarälvdalens Datakonsult AB, a KDAB Group company, info@kdab.com, author David Faure <david.faure@kdab.com>
// SPDX-License-Identifier: GPL-3.0-only OR LicenseRef-Slint-Royalty-free-2.0 OR LicenseRef-Slint-Software-3.0

// Test FlexBoxLayout align-items property for row and column directions.
// align-items controls how individual items are aligned along the cross axis
// within each flex line.

component VisibleRect inherits Rectangle {
    border-width: 1px;
    border-color: black;
}

// === Row direction tests ===

// Test 1: align-items: start — items at top of flex line
component TestAlignItemsStartRow inherits VisibleRect {
    width: 300px;
    height: 300px;

    FlexBoxLayout {
        align-content: start;
        align-items: start;

        r1 := Rectangle {
            width: 50px;
            height: 20px;
            background: red;
        }

        r2 := Rectangle {
            width: 50px;
            height: 40px;
            background: green;
        }

        r3 := Rectangle {
            width: 50px;
            height: 60px;
            background: blue;
        }
    }

    // All items at y=0, heights preserved
    out property <bool> test:
        r1.y == 0px && r1.height == 20px && r2.y == 0px && r2.height == 40px && r3.y == 0px && r3.height == 60px;
}

// Test 2: align-items: end — items at bottom of flex line
component TestAlignItemsEndRow inherits VisibleRect {
    width: 300px;
    height: 300px;

    FlexBoxLayout {
        align-content: start;
        align-items: end;

        r1 := Rectangle {
            width: 50px;
            height: 20px;
            background: red;
        }

        r2 := Rectangle {
            width: 50px;
            height: 40px;
            background: green;
        }

        r3 := Rectangle {
            width: 50px;
            height: 60px;
            background: blue;
        }
    }

    // Line height = 60 (tallest item), items at bottom of line
    out property <bool> test:
        r1.y == 40px && r1.height == 20px && r2.y == 20px && r2.height == 40px && r3.y == 0px && r3.height == 60px;
}

// Test 3: align-items: center — items centered in flex line
component TestAlignItemsCenterRow inherits VisibleRect {
    width: 300px;
    height: 300px;

    FlexBoxLayout {
        align-content: start;
        align-items: center;

        r1 := Rectangle {
            width: 50px;
            height: 20px;
            background: red;
        }

        r2 := Rectangle {
            width: 50px;
            height: 40px;
            background: green;
        }

        r3 := Rectangle {
            width: 50px;
            height: 60px;
            background: blue;
        }
    }

    // Line height = 60, items centered: y = (60 - height) / 2
    out property <bool> test:
        r1.y == 20px && r1.height == 20px && r2.y == 10px && r2.height == 40px && r3.y == 0px && r3.height == 60px;
}

// Test 4: align-items: stretch (Row) — items without explicit height stretch to fill line
component TestAlignItemsStretchRow inherits VisibleRect {
    width: 300px;
    height: 300px;

    FlexBoxLayout {
        // align-content: stretch (default) — single line fills container height
        // align-items: stretch (default) — items stretch to line height
        r1 := Rectangle {
            width: 50px;
            background: red;
        }

        r2 := Rectangle {
            width: 100px;
            background: green;
        }

        r3 := Rectangle {
            width: 150px;
            background: blue;
        }
    }

    // All items stretch to full container height (300px)
    out property <bool> test:
        r1.y == 0px && r1.height == 300px && r2.y == 0px && r2.height == 300px && r3.y == 0px && r3.height == 300px;
}

// === Column direction tests ===

// Test 5: align-items: start (Column) — items at left of flex line
component TestAlignItemsStartColumn inherits VisibleRect {
    width: 300px;
    height: 300px;

    FlexBoxLayout {
        flex-direction: column;
        align-content: start;
        align-items: start;

        r1 := Rectangle {
            width: 20px;
            height: 50px;
            background: red;
        }

        r2 := Rectangle {
            width: 40px;
            height: 50px;
            background: green;
        }

        r3 := Rectangle {
            width: 60px;
            height: 50px;
            background: blue;
        }
    }

    // All items at x=0, widths preserved
    out property <bool> test:
        r1.x == 0px && r1.width == 20px && r2.x == 0px && r2.width == 40px && r3.x == 0px && r3.width == 60px;
}

// Test 6: align-items: end (Column) — items at right of flex line
component TestAlignItemsEndColumn inherits VisibleRect {
    width: 300px;
    height: 300px;

    FlexBoxLayout {
        flex-direction: column;
        align-content: start;
        align-items: end;

        r1 := Rectangle {
            width: 20px;
            height: 50px;
            background: red;
        }

        r2 := Rectangle {
            width: 40px;
            height: 50px;
            background: green;
        }

        r3 := Rectangle {
            width: 60px;
            height: 50px;
            background: blue;
        }
    }

    // Column width = 60 (widest item), items at right of line
    out property <bool> test:
        r1.x == 40px && r1.width == 20px && r2.x == 20px && r2.width == 40px && r3.x == 0px && r3.width == 60px;
}

// Test 7: align-items: center (Column) — items centered in flex line
component TestAlignItemsCenterColumn inherits VisibleRect {
    width: 300px;
    height: 300px;

    FlexBoxLayout {
        flex-direction: column;
        align-content: start;
        align-items: center;

        r1 := Rectangle {
            width: 20px;
            height: 50px;
            background: red;
        }

        r2 := Rectangle {
            width: 40px;
            height: 50px;
            background: green;
        }

        r3 := Rectangle {
            width: 60px;
            height: 50px;
            background: blue;
        }
    }

    // Column width = 60 (widest item), items centered: x = (60 - width) / 2
    out property <bool> test:
        r1.x == 20px && r1.width == 20px && r2.x == 10px && r2.width == 40px && r3.x == 0px && r3.width == 60px;
}

// Test 8: align-items: stretch (Column) — items without explicit width stretch to fill line
component TestAlignItemsStretchColumn inherits VisibleRect {
    width: 300px;
    height: 300px;

    FlexBoxLayout {
        flex-direction: column;
        // align-content: stretch (default) — single column fills container width
        // align-items: stretch (default) — items stretch to column width
        r1 := Rectangle {
            height: 50px;
            background: red;
        }

        r2 := Rectangle {
            height: 100px;
            background: green;
        }

        r3 := Rectangle {
            height: 150px;
            background: blue;
        }
    }

    // All items stretch to full container width (300px)
    out property <bool> test:
        r1.x == 0px && r1.width == 300px && r2.x == 0px && r2.width == 300px && r3.x == 0px && r3.width == 300px;
}

// Instantiate all test components
export component Main inherits Rectangle {
    width: self.preferred-width;
    height: self.preferred-height;

    HorizontalLayout {
        spacing: 10px;
        padding: 10px;
        VerticalLayout {
            spacing: 10px;
            padding: 10px;
            t1 := TestAlignItemsStartRow { }

            t2 := TestAlignItemsEndRow { }

            t3 := TestAlignItemsCenterRow { }

            t4 := TestAlignItemsStretchRow { }
        }

        VerticalLayout {
            spacing: 10px;
            padding: 10px;

            t5 := TestAlignItemsStartColumn { }

            t6 := TestAlignItemsEndColumn { }

            t7 := TestAlignItemsCenterColumn { }

            t8 := TestAlignItemsStretchColumn { }
        }
    }

    out property <bool> test: t1.test && t2.test && t3.test && t4.test && t5.test && t6.test && t7.test && t8.test;
}
