// Copyright Â© SixtyFPS GmbH <info@slint.dev>
// SPDX-License-Identifier: MIT

export component SpriteSheet {

    in property <image> source;
    in property <int> framesWide;
    in property <int> framesHigh;
    in property <int> totalFrames;
    in-out property <bool> playing: false;
    in property <duration> duration;
    in property <int> frame: 0;

    property <int> currentFrame: playing ? (totalFrames * (animation-tick() / duration)).mod(totalFrames) : frame.mod(totalFrames).abs();

    @children

    sheet :=Image {
        source: root.source;
        source-clip-width: self.source.width / root.framesWide;
        source-clip-height: self.source.height / root.framesHigh;
        source-clip-x: self.source-clip-width * currentFrame.mod(root.framesWide);
        source-clip-y: self.source-clip-height * (currentFrame / root.framesWide).floor();
        width: self.source.width / root.framesWide * 0.5px;
        height: self.source.height / root.framesHigh * 0.5px;
    }
    
}
