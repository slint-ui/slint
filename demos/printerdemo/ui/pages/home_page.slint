// Copyright Â© SixtyFPS GmbH <info@slint.dev>
// SPDX-License-Identifier: MIT

import { DemoPalette, Theme, SubPage, PrinterState } from "../common.slint";
import { CopyPage } from "./copy_page.slint";
import { ScanPage } from "./scan_page.slint";
import { PrintPage } from "./print_page.slint";
import { PrinterQueueView } from "../printer_queue.slint";
import { UsbPage } from "./usb_page.slint";
import { Page } from "./page.slint";
component ActionButton  {
    in property <image> icon <=> img.source;
    in property <string> text <=> label.text;
    in property <brush> background <=> img-back.colorize;

    width: DemoPalette.button-width;
    height: DemoPalette.button-height;
    img-back := Image {
        width: 100%;
        height: 100%;
        source: @image-url("../images/action-button-frame.png");
        colorize: white;
    }

    callback clicked;

    VerticalLayout {
        spacing: 10px;
        width: self.preferred-width;
        height: self.preferred-height;

        Rectangle {
            width: 64px;
            height: self.width;
            background: white.with-alpha(0.2);
            border-radius: 16px;

            img := Image {
                width: 32px;
                colorize: white;
            }
        }

        label := Text {
            font-size: 18px;
            font-weight: DemoPalette.medium-weight;
            horizontal-alignment: center;
            color: white;
        }
    }

    TouchArea {
        width: 249px;
        clicked => {
            root.clicked()
        }
    }
}

export component HomePage inherits Page {
    in-out property <length> header-row-height: 40px;
    in-out property <length> button-spacing: 35px;

    has-header: false;

    Text {
        x: DemoPalette.default-margin;
        y: DemoPalette.default-margin;
        text: @tr("Slint Printer Demo");
        color: DemoPalette.text-primary;
        font-size: DemoPalette.title-font-size;
        font-weight: DemoPalette.medium-weight;
    }



    
    gl := GridLayout {
        x: DemoPalette.default-margin;
        y: parent.height - DemoPalette.default-margin - self.preferred-height;
        width: self.preferred-width;
        height: self.preferred-height;
        spacing: 16px;

        for action[index] in [
            {
                name: @tr("Print"),
                id: SubPage.print,
                icon: @image-url("../images/print.svg"),
                background:  @linear-gradient(135deg, #2B7FFF 0%, #155DFC 100%)
            },
            {
                name: @tr("Scan"),
                id: SubPage.scan,
                icon: @image-url("../images/scan.svg"),
                background:  @linear-gradient(135deg, #00BC7D 0%, #009966 100%)
            },
            {
                name: @tr("Copy"),
                id: SubPage.copy,
                icon: @image-url("../images/copy.svg"),
                background:  @linear-gradient(135deg, #FF2056 0%, #fd3d6d 100%)
            },
            {
                name: @tr("USB"),
                id: SubPage.usb,
                icon: @image-url("../images/usb.svg"),
                background:  @linear-gradient(135deg, #FF6900 0%, #F54900 100%)
            },
        ]: ActionButton {
            col: index.mod(2);
            row: index / 2;
            icon: action.icon;
            text: action.name;
            background: action.background;
            clicked => {
                PrinterState.current-subpage = action.id;
            }
        }
    }

    queue-view := PrinterQueueView {
        show-job-details(idx) => {
            PrinterState.current-subpage = SubPage.print;
        }

        x: parent.width - self.width;
        width: root.width - (DemoPalette.default-margin * 2) - gl.width;
    }

    PrintPage {
        back => {
            PrinterState.current-subpage = SubPage.none;
        }
        x: PrinterState.current-subpage == SubPage.print ? 0 : parent.width + parent.x + 2px;
        animate x {
            duration: 125ms;
            easing: ease;
        }
    }

    ScanPage {
        back => {
            PrinterState.current-subpage = SubPage.none;
        }
        x: PrinterState.current-subpage == SubPage.scan ? 0 : parent.width + parent.x + 2px;
    }

    CopyPage {
        back => {
            PrinterState.current-subpage = SubPage.none;
        }
        x: PrinterState.current-subpage == SubPage.copy ? 0 : parent.width + parent.x + 2px;
    }

    UsbPage {
        back => {
            PrinterState.current-subpage = SubPage.none;
        }
        x: PrinterState.current-subpage == SubPage.usb ? 0 : parent.width + parent.x + 2px;
    }
}
