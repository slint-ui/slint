// Copyright Â© SixtyFPS GmbH <info@slint.dev>
// SPDX-License-Identifier: MIT

struct ButtonColors  {
    base: color,
    pressed: color,
    hovered: color,
}

export global DemoPalette {
    out property <length> side-bar-width: 36px;
    out property <length> header-height: 45px;
    // Color of the home/settings/ink buttons on the left side bar
    out property <color> header-background: white;
    out property <color> page-background: #F8FAFC;
    out property <color> active-page-icon-color: Colors.white;
    out property <color> inactive-page-icon-color: #90A1B9;
    out property <color> main-background: #0E133F;
    out property <color> neutral-box: #BDC0D1;
    out property <color> text-foreground-color: #473f74;
    out property <color> secondary-foreground-color: #6C6E7A;
    out property <color> printer-action-background-color: white;
    out property <color> status-label-text-color: #6284FF;

    // Color used for the border / outline of items that can be clicked on, such as the
    // "Print"/"Scan" buttons, the printer queue items (for expansion) or controls such
    // as the combo box or spin box.
    out property <color> control-outline-color: #FFBF63;
    out property <color> control-secondary: #6284FF;
    out property <color> control-foreground: #122F7B;  // FIXME: the night mode color was not part of the design
    out property <color> primary-push-button-base: #6284FF;
    out property <ButtonColors> primary-push-button-colors: {
        base: root.primary-push-button-base,
        pressed: root.primary-push-button-base.darker(40%),
        hovered: root.primary-push-button-base.darker(20%),
    };
    out property <color> secondary-push-button-base: #FFBF63;
    out property <ButtonColors> secondary-push-button-colors: {
        base: root.secondary-push-button-base,
        pressed: root.secondary-push-button-base.darker(40%),
        hovered: root.secondary-push-button-base.darker(20%),
    };
    out property <color> push-button-text-color: white;
    out property <length> base-font-size: 12px;
    out property <string> medium-font-family: "Inter 24pt Medium";
    out property <string> regular-font-family: "Inter 24pt Regular";
}

export component Page inherits Rectangle {
    in property <string> header <=> h.text;
    in property <bool> has-back-button: false;

    callback back;

    TouchArea { } // protect underneath controls

    VerticalLayout {
        page-header := Rectangle {
            width: 100%;
            height: DemoPalette.header-height;
            background: DemoPalette.header-background;

            if (root.has-back-button): Image {
                source: @image-url("images/back.svg");
                image-fit: contain;
                colorize: DemoPalette.control-secondary;
                y: h.y + (h.height - self.height) / 2;
                x: 5px;
                width: 14px;
                height: 24px;

                TouchArea {
                    pointer-event(ev) => {
                        if (ev.kind == PointerEventKind.up) {
                            root.back()
                        }
                    }
                    width: 400%;
                    height: 200%;
                    x: (parent.width - self.width) / 2;
                    y: (parent.height - self.height) / 2;
                }
            }

            h := Text {
                font-size: 22px;
                color: DemoPalette.text-foreground-color;
                x: root.has-back-button ? 30px + 16px : 12px;
                // font-family: DemoPalette.regular-font-family;

                // Allow clicking on the title as well to get back easier when just
                // using fingers on a small screen.
                if (root.has-back-button): TouchArea {
                    pointer-event(ev) => {
                        if (ev.kind == PointerEventKind.up) {
                            root.back()
                        }
                    }
                }
            }

            separator := Rectangle {
                y: parent.height - self.height;
                width: 100%;
                height: 1px;
                background: #E2E8F0;
            }
        }

        page-content := Rectangle {
            @children
        }
    }
}

export component Label inherits Text {
    color: DemoPalette.text-foreground-color;
    vertical-alignment: center;
    vertical-stretch: 0;
}

component SquareButton inherits Rectangle {
    in property <image> img;

    callback clicked;

    border-radius: 3px;
    border-width: 2px;
    border-color: DemoPalette.control-outline-color;

    touch := TouchArea {
        pointer-event(ev) => {
            if (ev.kind == PointerEventKind.down) {
                root.clicked()
            }
        }

        width: 120%;
        height: 120%;
    }

    Image {
        height: 12px;
        width: 12px;
        x: (parent.width - self.width) / 2;
        y: (parent.height - self.height) / 2;
        source <=> root.img;
        image-fit: contain;
        colorize: DemoPalette.control-secondary;
    }
}

export component SpinBox inherits Rectangle {
    in property <int> minimum;
    in property <int> maximum: 100;
    in-out property <int> value;

    height: 32px;

    HorizontalLayout {
        spacing: 12px;
        padding: 0;

        SquareButton {
            clicked => {
                if (root.value > root.minimum) {
                    root.value -= 1;
                }
            }

            width: root.height - parent.padding * 2;
            img: @image-url("images/minus.svg");
        }

        Rectangle {
            border-radius: 3px;
            border-width: 2px;
            border-color: DemoPalette.control-outline-color;

            Text {
                width: 100%;
                height: 100%;
                vertical-alignment: center;
                horizontal-alignment: center;
                text: root.value;
                color: DemoPalette.control-foreground;
            }
        }

        SquareButton {
            clicked => {
                if (root.value < root.maximum) {
                    root.value += 1;
                }
            }

            width: root.height - parent.padding * 2;
            img: @image-url("images/plus.svg");
        }
    }
}





export component PushButton inherits Rectangle {

    in property <string> text <=> label.text;
    in property <image> icon <=> img.source;
    in property <bool> primary: true;
    out property <bool> pressed: touch-area.pressed;
    out property <ButtonColors> colors: root.primary ? DemoPalette.primary-push-button-colors : DemoPalette.secondary-push-button-colors;

    callback clicked;

    border-radius: 13.5px;
    background: root.pressed ? root.colors.pressed : (touch-area.has-hover ? root.colors.hovered : root.colors.base);
    horizontal-stretch: 1;

    HorizontalLayout {
        padding-top: 5px;
        padding-bottom: 5px;
        padding-left: parent.border-radius;
        padding-right: parent.border-radius;

        img := Image {
            horizontal-stretch: 0;
            colorize: DemoPalette.push-button-text-color;
            image-fit: contain;
            width: 17px;
        }

        label := Text {
            font-size: DemoPalette.base-font-size * 0.975;
            color: DemoPalette.push-button-text-color;
            horizontal-alignment: center;
            vertical-alignment: center;
        }
    }

    touch-area := TouchArea {
        pointer-event(ev) => {
            if (ev.kind == PointerEventKind.up) {
                root.clicked()
            }
        }
    }
}
