# Copyright Â© SixtyFPS GmbH <info@slint.dev>
# SPDX-License-Identifier: GPL-3.0-only OR LicenseRef-Slint-Royalty-free-2.0 OR LicenseRef-Slint-Software-3.0

# Check license information and copyright headers
name: Check License infos

on: workflow_call

jobs:
    docs:
        runs-on: ubuntu-24.04
        env:
            # Allow deprecated warning because we are using nightly and some things might be deprecated in nightly
            # for which the stable alternative is not yet available.
            RUSTFLAGS: -D warnings -W deprecated
            RUSTDOCFLAGS: --html-in-header=/home/runner/work/slint/slint/docs/resources/slint-docs-highlight.html -D warnings -W deprecated
            SLINT_NO_QT: 1
            CARGO_INCREMENTAL: false
            RELEASE_INPUT: ${{ inputs.release }}
        steps:
            - uses: actions/checkout@v4
            - uses: pnpm/action-setup@v4.0.0
              with:
                version: 9.11.0
            - uses: ./.github/actions/install-linux-dependencies
              with:
                extra-packages: reuse
            - uses: ./.github/actions/setup-rust
              with:
                  toolchain: nightly
            - name: Check license headers
              run: cargo xtask check_license_headers --fix-it
            - name: Suggest license header changes
              uses: reviewdog/action-suggester@v1
              with:
                  tool_name: xtask license_header
                  level: error
                  fail_on_error: true
            - name: Check reuse compliance
              run: cargo xtask check_reuse_compliance
